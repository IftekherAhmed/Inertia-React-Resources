# Complete Laravel + React + Inertia.js Implementation Guide

## Project Setup & Structure

### 1. Database Layer Setup

#### Migration
```php
// database/migrations/2024_01_01_create_posts_table.php
Schema::create('posts', function (Blueprint $table) {
    $table->id();
    $table->string('title');
    $table->text('content');
    $table->string('image_path')->nullable();
    $table->boolean('published')->default(false);
    $table->timestamps();
});
```

#### Model
```php
// app/Models/Post.php
class Post extends Model
{
    protected $fillable = [
        'title', 'content', 'image_path', 'published'
    ];

    protected $casts = [
        'published' => 'boolean'
    ];

    // FOR SEARCH: Use this scope when you need to search across multiple fields
    public function scopeSearch($query, $search)
    {
        if (!$search) return $query;
        
        return $query->where(function($q) use ($search) {
            $q->where('title', 'like', "%{$search}%")
              ->orWhere('content', 'like', "%{$search}%");
        });
    }

    // FOR FILTER: Use this scope when you need boolean filtering
    public function scopePublished($query, $published)
    {
        if (is_null($published)) return $query;
        return $query->where('published', $published);
    }

    // FOR SORT: Use this scope when you need sorting functionality
    public function scopeSortBy($query, $sortBy = 'id', $sortDirection = 'desc')
    {
        $allowedSorts = ['id', 'title', 'created_at'];
        $sortBy = in_array($sortBy, $allowedSorts) ? $sortBy : 'id';
        $sortDirection = in_array(strtolower($sortDirection), ['asc', 'desc']) ? $sortDirection : 'desc';
        
        return $query->orderBy($sortBy, $sortDirection);
    }

    // FOR DATE FILTER: Use this when you need date range filtering
    public function scopeDateRange($query, $startDate, $endDate)
    {
        if ($startDate) $query->whereDate('created_at', '>=', $startDate);
        if ($endDate) $query->whereDate('created_at', '<=', $endDate);
        return $query;
    }
}
```

#### Factory & Seeder
```php
// database/factories/PostFactory.php
public function definition(): array
{
    return [
        'title' => fake()->sentence(),
        'content' => fake()->paragraphs(3, true),
        'published' => fake()->boolean(),
    ];
}

// database/seeders/PostSeeder.php
public function run(): void
{
    Post::factory()->count(50)->create();
}
```

### 2. Routes Setup
```php
// routes/web.php
Route::resource('posts', PostController::class);
```

### 3. Controller Implementation

#### Complete Controller with All Operations
```php
// app/Http/Controllers/PostController.php
class PostController extends Controller
{
    // FOR LISTING WITH ALL FEATURES: Use this for index page with search, filter, sort, pagination
    public function index(Request $request)
    {
        $filters = [
            'search' => $request->search,
            'published' => $request->published,
            'start_date' => $request->start_date,
            'end_date' => $request->end_date,
            'sort_by' => $request->sort_by ?? 'id',
            'sort_direction' => $request->sort_direction ?? 'desc',
            'per_page' => $request->per_page ?? 10,
        ];

        // FOR SEARCH + FILTER + SORT: Apply all operations at once
        $posts = Post::search($filters['search'])
                    ->published($filters['published'])
                    ->dateRange($filters['start_date'], $filters['end_date'])
                    ->sortBy($filters['sort_by'], $filters['sort_direction'])
                    ->paginate($filters['per_page']);

        return Inertia::render('Posts/Index', [
            'posts' => $posts->items(),
            'filters' => $filters,
            'pagination' => [
                'current_page' => $posts->currentPage(),
                'last_page' => $posts->lastPage(),
                'per_page' => $posts->perPage(),
                'total' => $posts->total(),
            ]
        ]);
    }

    // FOR STORE: Use this to create new resource with file upload
    public function store(PostRequest $request)
    {
        $post = new Post();
        
        // FOR FILE UPLOAD: Handle file upload if present
        if ($request->hasFile('image')) {
            $path = $request->file('image')->store('posts', 'public');
            $post->image_path = $path;
        }
        
        $post->title = $request->title;
        $post->content = $request->content;
        $post->published = $request->published ?? false;
        $post->save();

        return redirect()->route('posts.index')->with('success', 'Post created!');
    }

    // FOR UPDATE: Use this to update resource with file upload
    public function update(PostRequest $request, Post $post)
    {
        // FOR FILE UPLOAD UPDATE: Handle new file and delete old one
        if ($request->hasFile('image')) {
            // Delete old file
            if ($post->image_path) {
                Storage::disk('public')->delete($post->image_path);
            }
            // Store new file
            $path = $request->file('image')->store('posts', 'public');
            $post->image_path = $path;
        }
        
        $post->title = $request->title;
        $post->content = $request->content;
        $post->published = $request->published ?? false;
        $post->save();

        return redirect()->route('posts.index')->with('success', 'Post updated!');
    }

    // FOR DELETE: Use this to delete resource with file cleanup
    public function destroy(Post $post)
    {
        // FOR FILE CLEANUP: Delete associated file
        if ($post->image_path) {
            Storage::disk('public')->delete($post->image_path);
        }
        
        $post->delete();
        return redirect()->route('posts.index')->with('success', 'Post deleted!');
    }

    // FOR MODAL VIEW: Use this to show single resource
    public function show(Post $post)
    {
        return Inertia::render('Posts/Show', [
            'post' => $post
        ]);
    }
}
```

### 4. Form Validation
```php
// app/Http/Requests/PostRequest.php
class PostRequest extends FormRequest
{
    public function authorize(): bool
    {
        return true;
    }

    // FOR VALIDATION: Use these rules for store and update
    public function rules(): array
    {
        return [
            'title' => 'required|string|max:255',
            'content' => 'required|string',
            'image' => 'nullable|image|mimes:jpeg,png,jpg,gif|max:2048',
            'published' => 'boolean',
        ];
    }
}
```

## Frontend Implementation (React + Inertia)

### 1. Listing Page with All Features

```tsx
// resources/js/pages/Posts/Index.tsx
import { Head, router, usePage } from '@inertiajs/react';
import { useState } from 'react';

export default function PostIndex() {
    const { posts, filters, pagination } = usePage().props as any;
    
    // FOR SEARCH: State and handler for search
    const [search, setSearch] = useState(filters.search || '');
    const handleSearch = (value: string) => {
        setSearch(value);
        router.get('/posts', { ...filters, search: value, page: 1 }, {
            preserveState: true,
            replace: true
        });
    };

    // FOR FILTER: State and handler for published filter
    const [published, setPublished] = useState(filters.published || '');
    const handlePublishedFilter = (value: string) => {
        setPublished(value);
        router.get('/posts', { ...filters, published: value, page: 1 }, {
            preserveState: true,
            replace: true
        });
    };

    // FOR SORT: Handler for sorting
    const handleSort = (field: string) => {
        const direction = filters.sort_by === field && filters.sort_direction === 'asc' ? 'desc' : 'asc';
        router.get('/posts', { 
            ...filters, 
            sort_by: field, 
            sort_direction: direction 
        }, {
            preserveState: true,
            replace: true
        });
    };

    // FOR PAGINATION: Handler for page change
    const handlePageChange = (page: number) => {
        router.get('/posts', { ...filters, page }, {
            preserveState: true,
            replace: true
        });
    };

    // FOR DELETE: Handler with confirmation
    const handleDelete = (id: number) => {
        if (confirm('Are you sure?')) {
            router.delete(`/posts/${id}`);
        }
    };

    return (
        <div>
            <Head title="Posts" />
            
            {/* FOR SEARCH: Search input */}
            <input
                type="text"
                placeholder="Search posts..."
                value={search}
                onChange={(e) => handleSearch(e.target.value)}
            />

            {/* FOR FILTER: Published status filter */}
            <select 
                value={published} 
                onChange={(e) => handlePublishedFilter(e.target.value)}
            >
                <option value="">All Status</option>
                <option value="1">Published</option>
                <option value="0">Draft</option>
            </select>

            {/* FOR SORT: Sortable table headers */}
            <table>
                <thead>
                    <tr>
                        <th onClick={() => handleSort('title')}>
                            Title {filters.sort_by === 'title' && (
                                filters.sort_direction === 'asc' ? '↑' : '↓'
                            )}
                        </th>
                        <th onClick={() => handleSort('created_at')}>
                            Date {filters.sort_by === 'created_at' && (
                                filters.sort_direction === 'asc' ? '↑' : '↓'
                            )}
                        </th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {posts.map((post: any) => (
                        <tr key={post.id}>
                            <td>{post.title}</td>
                            <td>{new Date(post.created_at).toLocaleDateString()}</td>
                            <td>
                                <a href={`/posts/${post.id}/edit`}>Edit</a>
                                <button onClick={() => handleDelete(post.id)}>
                                    Delete
                                </button>
                            </td>
                        </tr>
                    ))}
                </tbody>
            </table>

            {/* FOR PAGINATION: Pagination controls */}
            <div>
                {Array.from({ length: pagination.last_page }, (_, i) => i + 1).map(page => (
                    <button
                        key={page}
                        onClick={() => handlePageChange(page)}
                        disabled={page === pagination.current_page}
                    >
                        {page}
                    </button>
                ))}
            </div>
        </div>
    );
}
```

### 2. Create/Edit Form with Validation

```tsx
// resources/js/pages/Posts/Create.tsx
import { useForm } from '@inertiajs/react';

export default function PostCreate() {
    // FOR FORM: Use form hook for form state management
    const { data, setData, post, processing, errors } = useForm({
        title: '',
        content: '',
        image: null as File | null,
        published: false,
    });

    // FOR SUBMIT: Handle form submission with file upload
    const handleSubmit = (e: React.FormEvent) => {
        e.preventDefault();
        
        // FOR FILE UPLOAD: Use FormData for file uploads
        const formData = new FormData();
        formData.append('title', data.title);
        formData.append('content', data.content);
        formData.append('published', data.published ? '1' : '0');
        if (data.image) {
            formData.append('image', data.image);
        }

        post('/posts', {
            data: formData,
            forceFormData: true,
        });
    };

    return (
        <form onSubmit={handleSubmit}>
            {/* FOR VALIDATION: Display validation errors */}
            {errors.title && <div>{errors.title}</div>}
            {errors.content && <div>{errors.content}</div>}
            {errors.image && <div>{errors.image}</div>}

            <input
                type="text"
                value={data.title}
                onChange={(e) => setData('title', e.target.value)}
                placeholder="Post title"
            />

            <textarea
                value={data.content}
                onChange={(e) => setData('content', e.target.value)}
                placeholder="Post content"
            />

            {/* FOR FILE UPLOAD: File input */}
            <input
                type="file"
                onChange={(e) => setData('image', e.target.files?.[0] || null)}
            />

            <label>
                <input
                    type="checkbox"
                    checked={data.published}
                    onChange={(e) => setData('published', e.target.checked)}
                />
                Published
            </label>

            <button type="submit" disabled={processing}>
                Create Post
            </button>
        </form>
    );
}
```

### 3. Modal View Component

```tsx
// resources/js/pages/Posts/Show.tsx
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';

export default function PostShow({ post, open, onClose }: any) {
    return (
        <Dialog open={open} onOpenChange={onClose}>
            <DialogContent>
                <DialogHeader>
                    <DialogTitle>{post.title}</DialogTitle>
                </DialogHeader>
                
                {post.image_path && (
                    <img 
                        src={`/storage/${post.image_path}`} 
                        alt={post.title}
                        className="w-full h-48 object-cover rounded"
                    />
                )}
                
                <div className="prose">
                    <p>{post.content}</p>
                </div>
                
                <div className="text-sm text-gray-500">
                    <p>Status: {post.published ? 'Published' : 'Draft'}</p>
                    <p>Created: {new Date(post.created_at).toLocaleDateString()}</p>
                </div>
            </DialogContent>
        </Dialog>
    );
}
```

## Quick Reference Guide

### FOR SEARCH: Use this query pattern
```php
// In Model
public function scopeSearch($query, $search)
{
    return $query->where('title', 'like', "%{$search}%")
                 ->orWhere('content', 'like', "%{$search}%");
}

// In Controller
Post::search($request->search)->get();
```

### FOR FILTER: Use this query pattern
```php
// In Model  
public function scopePublished($query, $published)
{
    if (!is_null($published)) {
        return $query->where('published', $published);
    }
    return $query;
}

// In Controller
Post::published($request->published)->get();
```

### FOR SORT: Use this query pattern
```php
// In Model
public function scopeSortBy($query, $sortBy, $sortDirection)
{
    return $query->orderBy($sortBy, $sortDirection);
}

// In Controller
Post::sortBy($request->sort_by, $request->sort_direction)->get();
```

### FOR PAGINATION: Use this query pattern
```php
// In Controller
Post::paginate($request->per_page ?? 10);
```

### FOR STORE: Use this pattern
```php
public function store(Request $request)
{
    $post = new Post();
    // Handle file upload if needed
    if ($request->hasFile('image')) {
        $path = $request->file('image')->store('posts', 'public');
        $post->image_path = $path;
    }
    // Fill other fields
    $post->fill($request->only(['title', 'content', 'published']));
    $post->save();
}
```

### FOR UPDATE: Use this pattern
```php
public function update(Request $request, Post $post)
{
    // Handle file update if needed
    if ($request->hasFile('image')) {
        // Delete old file
        Storage::delete($post->image_path);
        // Store new file
        $path = $request->file('image')->store('posts', 'public');
        $post->image_path = $path;
    }
    // Update other fields
    $post->update($request->only(['title', 'content', 'published']));
}
```

### FOR DELETE: Use this pattern
```php
public function destroy(Post $post)
{
    // Delete associated file
    if ($post->image_path) {
        Storage::delete($post->image_path);
    }
    $post->delete();
}
```

### FOR VALIDATION: Use this pattern
```php
// In Form Request
public function rules()
{
    return [
        'title' => 'required|string|max:255',
        'content' => 'required|string',
        'image' => 'nullable|image|max:2048',
        'published' => 'boolean'
    ];
}
```

### FOR FILE UPLOAD: Use this pattern
```php
// In Controller
if ($request->hasFile('image')) {
    $path = $request->file('image')->store('folder_name', 'public');
    $model->image_path = $path;
}
```

## Key Points to Remember

1. **FOR SEARCH**: Always use model scopes for reusable search logic
2. **FOR FILTER**: Create separate scopes for each filter type
3. **FOR SORT**: Validate sort fields and directions before applying
4. **FOR PAGINATION**: Handle "show all" option with custom logic
5. **FOR FILE UPLOAD**: Always use FormData in frontend and handle file cleanup
6. **FOR VALIDATION**: Create Form Request classes for complex validation
7. **FOR MODALS**: Use separate show method and modal components

This guide provides specific implementation patterns that you can adapt to any Laravel + React + Inertia.js project. Each operation is clearly marked with "FOR [OPERATION]" to help you quickly find the relevant code patterns.