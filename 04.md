# Complete Laravel, Inertia.js & React Guide - Part 4

## Advanced Features and Implementation Patterns

### 1. Implementing File Uploads

#### Backend Changes

Update the Post model to handle file uploads:

File: `app/Models/Post.php` (updated)
```php
<?php

namespace App\Models;

use App\Models\Traits\Scopes\PostScopes;
use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Support\Facades\Storage;

class Post extends Model
{
    use HasFactory, PostScopes;

    protected $fillable = [
        'title',
        'description',
        'image',
        'is_published',
    ];

    protected $casts = [
        'is_published' => 'boolean',
        'created_at' => 'datetime',
        'updated_at' => 'datetime',
    ];

    // Accessor to get full image URL
    public function getImageUrlAttribute()
    {
        if ($this->image) {
            return Storage::url($this->image);
        }
        
        return null;
    }
}
```

Update the StorePostRequest to handle file uploads:

File: `app/Http/Requests/StorePostRequest.php` (updated)
```php
<?php

namespace App\Http\Requests;

use Illuminate\Foundation\Http\FormRequest;

class StorePostRequest extends FormRequest
{
    /**
     * Determine if the user is authorized to make this request.
     */
    public function authorize(): bool
    {
        return true;
    }

    /**
     * Get the validation rules that apply to the request.
     *
     * @return array<string, \Illuminate\Contracts\Validation\ValidationRule|array<mixed>|string>
     */
    public function rules(): array
    {
        return [
            'title' => 'required|string|max:255|unique:posts,title',
            'description' => 'nullable|string|max:1000',
            'image' => 'nullable|image|mimes:jpeg,png,jpg,gif|max:2048', // File upload validation
            'is_published' => 'boolean',
        ];
    }

    public function messages(): array
    {
        return [
            'title.required' => 'A title is required',
            'title.unique' => 'This title has already been taken',
            'description.max' => 'Description must not exceed 1000 characters',
            'image.image' => 'The file must be an image',
            'image.max' => 'The image must not be larger than 2MB',
        ];
    }
}
```

Update the PostController to handle file uploads:

File: `app/Http/Controllers/PostController.php` (updated)
```php
<?php

namespace App\Http\Controllers;

use App\Models\Post;
use App\Http\Requests\StorePostRequest;
use App\Http\Requests\UpdatePostRequest;
use Illuminate\Http\Request;
use Inertia\Inertia;
use Illuminate\Support\Facades\Storage;

class PostController extends Controller
{
    /**
     * Display a listing of the resource.
     */
    public function index(Request $request)
    {
        $search = $request->input('search');
        $sortBy = $request->input('sort_by', 'id');
        $sortDirection = $request->input('sort_direction', 'asc');
        $published = $request->input('published');
        $perPage = $request->input('per_page', 10);
        $page = $request->input('page', 1);
        
        $posts = Post::search($search)
            ->published($published)
            ->sortBy($sortBy, $sortDirection)
            ->paginateResults($perPage, $page);
        
        return Inertia::render('Post/Index', [
            'posts' => $posts,
            'filters' => [
                'search' => $search,
                'sort_by' => $sortBy,
                'sort_direction' => $sortDirection,
                'published' => $published,
                'per_page' => $perPage,
            ],
        ]);
    }

    /**
     * Store a newly created resource in storage.
     */
    public function store(StorePostRequest $request)
    {
        try {
            $data = $request->validated();
            
            // Handle file upload
            if ($request->hasFile('image')) {
                $data['image'] = $request->file('image')->store('posts', 'public');
            }
            
            $post = Post::create($data);
            
            return redirect()->route('post.index')->with('success', 'Post created successfully.');
        } catch (\Exception $e) {
            return back()->with('error', 'Failed to create post: ' . $e->getMessage());
        }
    }

    /**
     * Update the specified resource in storage.
     */
    public function update(UpdatePostRequest $request, Post $post)
    {
        try {
            $data = $request->validated();
            
            // Handle file upload
            if ($request->hasFile('image')) {
                // Delete old image if exists
                if ($post->image) {
                    Storage::disk('public')->delete($post->image);
                }
                
                $data['image'] = $request->file('image')->store('posts', 'public');
            }
            
            $post->update($data);
            
            return redirect()->route('post.index')->with('success', 'Post updated successfully.');
        } catch (\Exception $e) {
            return back()->with('error', 'Failed to update post: ' . $e->getMessage());
        }
    }

    /**
     * Remove the specified resource from storage.
     */
    public function destroy(Post $post)
    {
        try {
            // Delete image if exists
            if ($post->image) {
                Storage::disk('public')->delete($post->image);
            }
            
            $post->delete();
            
            return redirect()->route('post.index')->with('success', 'Post deleted successfully.');
        } catch (\Exception $e) {
            return back()->with('error', 'Failed to delete post: ' . $e->getMessage());
        }
    }

    // ... rest of the controller methods remain the same
}
```

#### Frontend Changes

Update the Create.tsx component to handle file uploads:

File: `resources/js/pages/Post/Create.tsx` (updated)
```tsx
import { Head, Link, useForm } from '@inertiajs/react';
import AppLayout from '@/layouts/app-layout';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Textarea } from '@/components/ui/textarea';
import { Switch } from '@/components/ui/switch';
import { useState } from 'react';

interface CreateProps {
  errors: Record<string, string>;
}

export default function Create({ errors }: CreateProps) {
  const { data, setData, post, processing } = useForm({
    title: '',
    description: '',
    image: '',
    is_published: false,
  });

  const [previewImage, setPreviewImage] = useState<string | null>(null);

  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
      setData('image', file);
      
      // Create preview
      const reader = new FileReader();
      reader.onload = (e) => {
        setPreviewImage(e.target?.result as string);
      };
      reader.readAsDataURL(file);
    }
  };

  const submit = (e: React.FormEvent) => {
    e.preventDefault();
    post(route('post.store'));
  };

  return (
    <AppLayout>
      <Head title="Create Post" />
      
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-2xl font-bold">Create Post</h1>
        <Button variant="outline" asChild>
          <Link href={route('post.index')}>Back to Posts</Link>
        </Button>
      </div>

      <Card>
        <CardHeader>
          <CardTitle>New Post</CardTitle>
        </CardHeader>
        <CardContent>
          <form onSubmit={submit} className="space-y-6">
            <div>
              <Label htmlFor="title">Title</Label>
              <Input
                id="title"
                value={data.title}
                onChange={(e) => setData('title', e.target.value)}
                className={errors.title ? 'border-red-500' : ''}
              />
              {errors.title && <p className="text-red-500 text-sm mt-1">{errors.title}</p>}
            </div>

            <div>
              <Label htmlFor="description">Description</Label>
              <Textarea
                id="description"
                value={data.description}
                onChange={(e) => setData('description', e.target.value)}
                className={errors.description ? 'border-red-500' : ''}
                rows={5}
              />
              {errors.description && <p className="text-red-500 text-sm mt-1">{errors.description}</p>}
            </div>

            <div>
              <Label htmlFor="image">Image</Label>
              <Input
                id="image"
                type="file"
                accept="image/*"
                onChange={handleImageChange}
                className={errors.image ? 'border-red-500' : ''}
              />
              {errors.image && <p className="text-red-500 text-sm mt-1">{errors.image}</p>}
              
              {previewImage && (
                <div className="mt-2">
                  <img 
                    src={previewImage} 
                    alt="Preview" 
                    className="max-w-xs max-h-40 object-cover rounded"
                  />
                </div>
              )}
            </div>

            <div className="flex items-center space-x-2">
              <Switch
                id="is_published"
                checked={data.is_published}
                onCheckedChange={(checked) => setData('is_published', checked)}
              />
              <Label htmlFor="is_published">Published</Label>
            </div>

            <div className="flex justify-end space-x-2">
              <Button variant="outline" asChild>
                <Link href={route('post.index')}>Cancel</Link>
              </Button>
              <Button type="submit" disabled={processing}>
                {processing ? 'Creating...' : 'Create Post'}
              </Button>
            </div>
          </form>
        </CardContent>
      </Card>
    </AppLayout>
  );
}
```

Update the Edit.tsx component to handle file uploads:

File: `resources/js/pages/Post/Edit.tsx` (updated)
```tsx
import { Head, Link, useForm } from '@inertiajs/react';
import AppLayout from '@/layouts/app-layout';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Textarea } from '@/components/ui/textarea';
import { Switch } from '@/components/ui/switch';
import { useState, useEffect } from 'react';

interface Post {
  id: number;
  title: string;
  description: string | null;
  image: string | null;
  image_url: string | null;
  is_published: boolean;
  created_at: string;
  updated_at: string;
}

interface EditProps {
  post: Post;
  errors: Record<string, string>;
}

export default function Edit({ post, errors }: EditProps) {
  const { data, setData, put, processing } = useForm({
    title: post.title,
    description: post.description || '',
    image: '',
    is_published: post.is_published,
  });

  const [previewImage, setPreviewImage] = useState<string | null>(post.image_url || null);
  const [removeImage, setRemoveImage] = useState(false);

  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
      setData('image', file);
      setRemoveImage(false);
      
      // Create preview
      const reader = new FileReader();
      reader.onload = (e) => {
        setPreviewImage(e.target?.result as string);
      };
      reader.readAsDataURL(file);
    }
  };

  const handleRemoveImage = () => {
    setPreviewImage(null);
    setRemoveImage(true);
    setData('image', '');
  };

  const submit = (e: React.FormEvent) => {
    e.preventDefault();
    
    // Include remove_image flag if needed
    const formData = new FormData();
    formData.append('title', data.title);
    formData.append('description', data.description);
    formData.append('is_published', data.is_published.toString());
    
    if (data.image instanceof File) {
      formData.append('image', data.image);
    }
    
    if (removeImage) {
      formData.append('remove_image', '1');
    }
    
    put(route('post.update', post.id), {
      data: formData,
    });
  };

  return (
    <AppLayout>
      <Head title="Edit Post" />
      
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-2xl font-bold">Edit Post</h1>
        <Button variant="outline" asChild>
          <Link href={route('post.index')}>Back to Posts</Link>
        </Button>
      </div>

      <Card>
        <CardHeader>
          <CardTitle>Edit Post</CardTitle>
        </CardHeader>
        <CardContent>
          <form onSubmit={submit} className="space-y-6">
            <div>
              <Label htmlFor="title">Title</Label>
              <Input
                id="title"
                value={data.title}
                onChange={(e) => setData('title', e.target.value)}
                className={errors.title ? 'border-red-500' : ''}
              />
              {errors.title && <p className="text-red-500 text-sm mt-1">{errors.title}</p>}
            </div>

            <div>
              <Label htmlFor="description">Description</Label>
              <Textarea
                id="description"
                value={data.description}
                onChange={(e) => setData('description', e.target.value)}
                className={errors.description ? 'border-red-500' : ''}
                rows={5}
              />
              {errors.description && <p className="text-red-500 text-sm mt-1">{errors.description}</p>}
            </div>

            <div>
              <Label htmlFor="image">Image</Label>
              <Input
                id="image"
                type="file"
                accept="image/*"
                onChange={handleImageChange}
                className={errors.image ? 'border-red-500' : ''}
              />
              {errors.image && <p className="text-red-500 text-sm mt-1">{errors.image}</p>}
              
              {previewImage && (
                <div className="mt-2 flex items-center space-x-4">
                  <img 
                    src={previewImage} 
                    alt="Preview" 
                    className="max-w-xs max-h-40 object-cover rounded"
                  />
                  <Button 
                    type="button" 
                    variant="destructive" 
                    onClick={handleRemoveImage}
                  >
                    Remove Image
                  </Button>
                </div>
              )}
              
              {!previewImage && post.image && (
                <p className="text-sm text-gray-500 mt-2">
                  Current image will be kept. Upload a new image to replace it.
                </p>
              )}
            </div>

            <div className="flex items-center space-x-2">
              <Switch
                id="is_published"
                checked={data.is_published}
                onCheckedChange={(checked) => setData('is_published', checked)}
              />
              <Label htmlFor="is_published">Published</Label>
            </div>

            <div className="flex justify-end space-x-2">
              <Button variant="outline" asChild>
                <Link href={route('post.index')}>Cancel</Link>
              </Button>
              <Button type="submit" disabled={processing}>
                {processing ? 'Updating...' : 'Update Post'}
              </Button>
            </div>
          </form>
        </CardContent>
      </Card>
    </AppLayout>
  );
}
```

### 2. Implementing Soft Deletes

#### Backend Changes

Update the Post migration to add soft deletes:

File: `database/migrations/xxxx_xx_xx_create_posts_table.php` (updated)
```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    /**
     * Run the migrations.
     */
    public function up(): void
    {
        Schema::create('posts', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->text('description')->nullable();
            $table->string('image')->nullable();
            $table->boolean('is_published')->default(false);
            $table->timestamps();
            $table->softDeletes(); // Add soft deletes
        });
    }

    /**
     * Reverse the migrations.
     */
    public function down(): void
    {
        Schema::dropIfExists('posts');
    }
};
```

Update the Post model to use soft deletes:

File: `app/Models/Post.php` (updated)
```php
<?php

namespace App\Models;

use App\Models\Traits\Scopes\PostScopes;
use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes; // Add soft deletes
use Illuminate\Support\Facades\Storage;

class Post extends Model
{
    use HasFactory, PostScopes, SoftDeletes; // Add SoftDeletes trait

    protected $fillable = [
        'title',
        'description',
        'image',
        'is_published',
    ];

    protected $casts = [
        'is_published' => 'boolean',
        'created_at' => 'datetime',
        'updated_at' => 'datetime',
        'deleted_at' => 'datetime',
    ];

    // Accessor to get full image URL
    public function getImageUrlAttribute()
    {
        if ($this->image) {
            return Storage::url($this->image);
        }
        
        return null;
    }
}
```

Update the PostController to handle soft deletes:

File: `app/Http/Controllers/PostController.php` (updated)
```php
<?php

namespace App\Http\Controllers;

use App\Models\Post;
use App\Http\Requests\StorePostRequest;
use App\Http\Requests\UpdatePostRequest;
use Illuminate\Http\Request;
use Inertia\Inertia;
use Illuminate\Support\Facades\Storage;

class PostController extends Controller
{
    // ... other methods remain the same

    /**
     * Remove the specified resource from storage.
     */
    public function destroy(Post $post)
    {
        try {
            // Don't actually delete the file immediately
            // Instead, mark as deleted and handle cleanup later if needed
            
            $post->delete();
            
            return redirect()->route('post.index')->with('success', 'Post deleted successfully.');
        } catch (\Exception $e) {
            return back()->with('error', 'Failed to delete post: ' . $e->getMessage());
        }
    }

    /**
     * Restore the specified resource from storage.
     */
    public function restore($id)
    {
        try {
            $post = Post::withTrashed()->findOrFail($id);
            $post->restore();
            
            return redirect()->route('post.index')->with('success', 'Post restored successfully.');
        } catch (\Exception $e) {
            return back()->with('error', 'Failed to restore post: ' . $e->getMessage());
        }
    }

    /**
     * Permanently remove the specified resource from storage.
     */
    public function forceDelete($id)
    {
        try {
            $post = Post::withTrashed()->findOrFail($id);
            
            // Delete image if exists
            if ($post->image) {
                Storage::disk('public')->delete($post->image);
            }
            
            $post->forceDelete();
            
            return redirect()->route('post.index')->with('success', 'Post permanently deleted.');
        } catch (\Exception $e) {
            return back()->with('error', 'Failed to permanently delete post: ' . $e->getMessage());
        }
    }
}
```

Add routes for restore and force delete:

File: `routes/web.php` (updated)
```php
<?php

use App\Http\Controllers\PostController;
use Illuminate\Support\Facades\Route;

Route::resource('post', PostController::class);

// Add additional routes for soft deletes
Route::post('/post/{id}/restore', [PostController::class, 'restore'])->name('post.restore');
Route::delete('/post/{id}/force-delete', [PostController::class, 'forceDelete'])->name('post.force-delete');
```

### 3. Implementing API Endpoints

Create an API controller for the Post model:

Command:
```bash
php artisan make:controller Api/PostController --model=Post --api
```

File: `app/Http/Controllers/Api/PostController.php`
```php
<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use App\Models\Post;
use App\Http\Requests\StorePostRequest;
use App\Http\Requests\UpdatePostRequest;
use Illuminate\Http\Request;

class PostController extends Controller
{
    /**
     * Display a listing of the resource.
     */
    public function index(Request $request)
    {
        $search = $request->input('search');
        $sortBy = $request->input('sort_by', 'id');
        $sortDirection = $request->input('sort_direction', 'asc');
        $published = $request->input('published');
        $perPage = $request->input('per_page', 10);
        
        $posts = Post::search($search)
            ->published($published)
            ->sortBy($sortBy, $sortDirection)
            ->paginate($perPage);
        
        return response()->json($posts);
    }

    /**
     * Store a newly created resource in storage.
     */
    public function store(StorePostRequest $request)
    {
        try {
            $data = $request->validated();
            
            // Handle file upload
            if ($request->hasFile('image')) {
                $data['image'] = $request->file('image')->store('posts', 'public');
            }
            
            $post = Post::create($data);
            
            return response()->json($post, 201);
        } catch (\Exception $e) {
            return response()->json(['error' => 'Failed to create post: ' . $e->getMessage()], 500);
        }
    }

    /**
     * Display the specified resource.
     */
    public function show(Post $post)
    {
        return response()->json($post);
    }

    /**
     * Update the specified resource in storage.
     */
    public function update(UpdatePostRequest $request, Post $post)
    {
        try {
            $data = $request->validated();
            
            // Handle file upload
            if ($request->hasFile('image')) {
                // Delete old image if exists
                if ($post->image) {
                    Storage::disk('public')->delete($post->image);
                }
                
                $data['image'] = $request->file('image')->store('posts', 'public');
            }
            
            $post->update($data);
            
            return response()->json($post);
        } catch (\Exception $e) {
            return response()->json(['error' => 'Failed to update post: ' . $e->getMessage()], 500);
        }
    }

    /**
     * Remove the specified resource from storage.
     */
    public function destroy(Post $post)
    {
        try {
            $post->delete();
            
            return response()->json(['message' => 'Post deleted successfully.']);
        } catch (\Exception $e) {
            return response()->json(['error' => 'Failed to delete post: ' . $e->getMessage()], 500);
        }
    }
}
```

Add API routes:

File: `routes/api.php`
```php
<?php

use App\Http\Controllers\Api\PostController;
use Illuminate\Support\Facades\Route;

Route::apiResource('posts', PostController::class);
```

### 4. Implementing Caching

Add caching to improve performance:

File: `app/Http/Controllers/PostController.php` (updated)
```php
<?php

namespace App\Http\Controllers;

use App\Models\Post;
use App\Http\Requests\StorePostRequest;
use App\Http\Requests\UpdatePostRequest;
use Illuminate\Http\Request;
use Inertia\Inertia;
use Illuminate\Support\Facades\Storage;
use Illuminate\Support\Facades\Cache;

class PostController extends Controller
{
    /**
     * Display a listing of the resource.
     */
    public function index(Request $request)
    {
        $search = $request->input('search');
        $sortBy = $request->input('sort_by', 'id');
        $sortDirection = $request->input('sort_direction', 'asc');
        $published = $request->input('published');
        $perPage = $request->input('per_page', 10);
        $page = $request->input('page', 1);
        
        // Create cache key based on filters
        $cacheKey = "posts_{$search}_{$sortBy}_{$sortDirection}_{$published}_{$perPage}_{$page}";
        
        $posts = Cache::remember($cacheKey, 300, function() use ($search, $sortBy, $sortDirection, $published, $perPage, $page) {
            return Post::search($search)
                ->published($published)
                ->sortBy($sortBy, $sortDirection)
                ->paginateResults($perPage, $page);
        });
        
        return Inertia::render('Post/Index', [
            'posts' => $posts,
            'filters' => [
                'search' => $search,
                'sort_by' => $sortBy,
                'sort_direction' => $sortDirection,
                'published' => $published,
                'per_page' => $perPage,
            ],
        ]);
    }

    // ... other methods remain the same
}
```

Clear cache when posts are modified:

File: `app/Http/Controllers/PostController.php` (updated methods)
```php
/**
 * Store a newly created resource in storage.
 */
public function store(StorePostRequest $request)
{
    try {
        $data = $request->validated();
        
        // Handle file upload
        if ($request->hasFile('image')) {
            $data['image'] = $request->file('image')->store('posts', 'public');
        }
        
        $post = Post::create($data);
        
        // Clear cache
        Cache::flush();
        
        return redirect()->route('post.index')->with('success', 'Post created successfully.');
    } catch (\Exception $e) {
        return back()->with('error', 'Failed to create post: ' . $e->getMessage());
    }
}

/**
 * Update the specified resource in storage.
 */
public function update(UpdatePostRequest $request, Post $post)
{
    try {
        $data = $request->validated();
        
        // Handle file upload
        if ($request->hasFile('image')) {
            // Delete old image if exists
            if ($post->image) {
                Storage::disk('public')->delete($post->image);
            }
            
            $data['image'] = $request->file('image')->store('posts', 'public');
        }
        
        $post->update($data);
        
        // Clear cache
        Cache::flush();
        
        return redirect()->route('post.index')->with('success', 'Post updated successfully.');
    } catch (\Exception $e) {
        return back()->with('error', 'Failed to update post: ' . $e->getMessage());
    }
}

/**
 * Remove the specified resource from storage.
 */
public function destroy(Post $post)
{
    try {
        $post->delete();
        
        // Clear cache
        Cache::flush();
        
        return redirect()->route('post.index')->with('success', 'Post deleted successfully.');
    } catch (\Exception $e) {
        return back()->with('error', 'Failed to delete post: ' . $e->getMessage());
    }
}
```

## Testing Your Implementation

### 1. Backend Testing

Create a feature test for the Post controller:

Command:
```bash
php artisan make:test PostControllerTest
```

File: `tests/Feature/PostControllerTest.php`
```php
<?php

namespace Tests\Feature;

use App\Models\Post;
use App\Models\User;
use Illuminate\Foundation\Testing\RefreshDatabase;
use Tests\TestCase;

class PostControllerTest extends TestCase
{
    use RefreshDatabase;

    protected $user;

    protected function setUp(): void
    {
        parent::setUp();
        $this->user = User::factory()->create();
    }

    /** @test */
    public function it_displays_posts_index_page()
    {
        $response = $this->actingAs($this->user)->get(route('post.index'));
        
        $response->assertStatus(200);
        $response->assertInertia(fn ($page) => $page->component('Post/Index'));
    }

    /** @test */
    public function it_displays_create_post_page()
    {
        $response = $this->actingAs($this->user)->get(route('post.create'));
        
        $response->assertStatus(200);
        $response->assertInertia(fn ($page) => $page->component('Post/Create'));
    }

    /** @test */
    public function it_creates_a_new_post()
    {
        $postData = [
            'title' => 'Test Post',
            'description' => 'This is a test post',
            'is_published' => true,
        ];

        $response = $this->actingAs($this->user)->post(route('post.store'), $postData);
        
        $response->assertRedirect(route('post.index'));
        $this->assertDatabaseHas('posts', $postData);
    }

    /** @test */
    public function it_displays_edit_post_page()
    {
        $post = Post::factory()->create();

        $response = $this->actingAs($this->user)->get(route('post.edit', $post));
        
        $response->assertStatus(200);
        $response->assertInertia(fn ($page) => $page->component('Post/Edit'));
    }

    /** @test */
    public function it_updates_an_existing_post()
    {
        $post = Post::factory()->create();
        $updatedData = [
            'title' => 'Updated Post',
            'description' => 'This post has been updated',
            'is_published' => false,
        ];

        $response = $this->actingAs($this->user)->put(route('post.update', $post), $updatedData);
        
        $response->assertRedirect(route('post.index'));
        $this->assertDatabaseHas('posts', $updatedData);
    }

    /** @test */
    public function it_deletes_a_post()
    {
        $post = Post::factory()->create();

        $response = $this->actingAs($this->user)->delete(route('post.destroy', $post));
        
        $response->assertRedirect(route('post.index'));
        $this->assertSoftDeleted('posts', ['id' => $post->id]);
    }
}
```

### 2. Frontend Testing

Create a unit test for a React component:

File: `resources/js/__tests__/PostIndex.test.tsx`
```tsx
import { render, screen } from '@testing-library/react';
import { createInertiaApp } from '@inertiajs/react';
import Index from '../pages/Post/Index';

// Mock Inertia hooks
jest.mock('@inertiajs/react', () => ({
  ...jest.requireActual('@inertiajs/react'),
  usePage: () => ({
    props: {
      posts: {
        data: [
          { id: 1, title: 'Test Post 1', description: 'Description 1', is_published: true, created_at: '2023-01-01' },
          { id: 2, title: 'Test Post 2', description: 'Description 2', is_published: false, created_at: '2023-01-02' },
        ],
        meta: {
          current_page: 1,
          last_page: 1,
          per_page: 10,
          total: 2,
          from: 1,
          to: 2,
          links: [],
        },
      },
      filters: {
        search: '',
        sort_by: 'id',
        sort_direction: 'asc',
        published: '',
        per_page: 10,
      },
    },
  }),
  router: {
    get: jest.fn(),
  },
}));

describe('Post Index Component', () => {
  it('renders the posts table', () => {
    render(<Index />);
    
    expect(screen.getByText('Posts')).toBeInTheDocument();
    expect(screen.getByText('Test Post 1')).toBeInTheDocument();
    expect(screen.getByText('Test Post 2')).toBeInTheDocument();
  });

  it('displays the correct number of posts', () => {
    render(<Index />);
    
    const rows = screen.getAllByRole('row');
    // +1 for header row
    expect(rows).toHaveLength(3);
  });

  it('shows published status correctly', () => {
    render(<Index />);
    
    expect(screen.getByText('Published')).toBeInTheDocument();
    expect(screen.getByText('Draft')).toBeInTheDocument();
  });
});
```

## Deployment Considerations

### 1. Production Environment Setup

Create a production deployment script:

File: `deploy.sh`
```bash
#!/bin/bash

# Pull latest code
git pull origin main

# Install/update PHP dependencies
composer install --no-dev --optimize-autoloader

# Install/update Node dependencies
npm ci

# Build frontend assets
npm run build

# Run migrations
php artisan migrate --force

# Clear and rebuild caches
php artisan cache:clear
php artisan config:cache
php artisan route:cache
php artisan view:cache

# Restart queue workers
php artisan queue:restart

echo "Deployment completed successfully!"
```

### 2. Environment Configuration

File: `.env.production`
```env
APP_NAME="Laravel React App"
APP_ENV=production
APP_KEY=
APP_DEBUG=false
APP_URL=https://yourdomain.com

LOG_CHANNEL=stack
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=debug

DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=your_database
DB_USERNAME=your_username
DB_PASSWORD=your_password

BROADCAST_DRIVER=log
CACHE_DRIVER=redis
FILESYSTEM_DISK=local
QUEUE_CONNECTION=redis
SESSION_DRIVER=redis
SESSION_LIFETIME=120

MEMCACHED_HOST=127.0.0.1

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=mailhog
MAIL_PORT=1025
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS="hello@example.com"
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=
AWS_USE_PATH_STYLE_ENDPOINT=false

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_HOST=
PUSHER_PORT=443
PUSHER_SCHEME=https
PUSHER_APP_CLUSTER=mt1

VITE_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
VITE_PUSHER_HOST="${PUSHER_HOST}"
VITE_PUSHER_PORT="${PUSHER_PORT}"
VITE_PUSHER_SCHEME="${PUSHER_SCHEME}"
VITE_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
```

## Conclusion

This comprehensive guide has provided you with everything you need to build robust CRUD applications using Laravel, Inertia.js, and React. By following the patterns and examples shown here, you can:

1. Create maintainable and scalable applications
2. Implement common features like search, sort, filter, and pagination
3. Handle file uploads and image management
4. Implement soft deletes for data recovery
5. Create API endpoints for external integrations
6. Add caching for improved performance
7. Write tests to ensure code quality
8. Deploy your application to production

The modular approach demonstrated in this guide allows you to pick and choose which features to implement based on your specific requirements, making it easy to adapt to various project needs. Remember to always follow security best practices, implement proper error handling, and write tests to ensure your application is robust and maintainable.