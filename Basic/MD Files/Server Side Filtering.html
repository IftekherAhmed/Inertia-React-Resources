<p>Iâ€™ll break down your client listing code into clear, step-by-step
parts showing how the React component interacts with the Laravel
controller.</p>
<h3 id="controller-breakdown-php">1. Controller Breakdown (PHP)</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> index(<span class="cn">R</span>equest <span class="va">$request</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 1. Get filter parameters from request</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">$search</span> <span class="op">=</span> <span class="va">$request</span>-&gt;input(<span class="st">&#39;search&#39;</span>)<span class="ot">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$company_id</span> <span class="op">=</span> <span class="va">$request</span>-&gt;input(<span class="st">&#39;company_id&#39;</span>)<span class="ot">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$perPage</span> <span class="op">=</span> <span class="va">$request</span>-&gt;input(<span class="st">&#39;per_page&#39;</span><span class="ot">,</span> <span class="dv">25</span>)<span class="ot">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 2. Base query with relationships</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">$query</span> <span class="op">=</span> <span class="cn">M</span>odelsClient::query()</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        -&gt;with(<span class="st">&#39;company&#39;</span>) <span class="co">// Eager load company data</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        -&gt;withCount(<span class="st">&#39;contacts&#39;</span>)<span class="ot">;</span> <span class="co">// Count contacts relationship</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 3. Apply search filter (if provided)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="va">$search</span>) {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">$query</span>-&gt;where(<span class="kw">function</span> (<span class="va">$q</span>) <span class="kw">use</span> (<span class="va">$search</span>) {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">$q</span>-&gt;where(<span class="st">&#39;id&#39;</span><span class="ot">,</span> <span class="st">&#39;like&#39;</span><span class="ot">,</span> <span class="st">&quot;%</span><span class="va">$search</span><span class="st">%&quot;</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>              -&gt;orWhere(<span class="st">&#39;name&#39;</span><span class="ot">,</span> <span class="st">&#39;like&#39;</span><span class="ot">,</span> <span class="st">&quot;%</span><span class="va">$search</span><span class="st">%&quot;</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>              <span class="co">// ... other searchable fields ...</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        })<span class="ot">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 4. Apply company filter (if provided)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="va">$company_id</span> <span class="op">&amp;&amp;</span> <span class="va">$company_id</span> <span class="op">!==</span> <span class="st">&#39;all&#39;</span>) {</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">$query</span>-&gt;where(<span class="st">&#39;company_id&#39;</span><span class="ot">,</span> <span class="va">$company_id</span>)<span class="ot">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 5. Handle pagination options</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="va">$perPage</span> <span class="op">===</span> <span class="st">&#39;all&#39;</span>) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">$clients</span> <span class="op">=</span> <span class="va">$query</span>-&gt;get()<span class="ot">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">$pagination</span> <span class="op">=</span> [<span class="co">/* custom pagination data */</span>]<span class="ot">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">$clients</span> <span class="op">=</span> <span class="va">$query</span>-&gt;paginate(<span class="va">$perPage</span>)<span class="ot">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">$pagination</span> <span class="op">=</span> [<span class="co">/* Laravel pagination data */</span>]<span class="ot">;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 6. Return data to React component</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">I</span>nertia::render(<span class="st">&#39;Client/Index&#39;</span><span class="ot">,</span> [</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;company_list&#39;</span> =&gt; <span class="cn">C</span>ompany::all()<span class="ot">,</span> <span class="co">// For company dropdown</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;client_list&#39;</span> =&gt; <span class="va">$clients</span><span class="ot">,</span> <span class="co">// The actual client data</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;pagination&#39;</span> =&gt; <span class="va">$pagination</span><span class="ot">,</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;filters&#39;</span> =&gt; [ <span class="co">// Current filter values</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;search&#39;</span> =&gt; <span class="va">$search</span><span class="ot">,</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;company_id&#39;</span> =&gt; <span class="va">$company_id</span><span class="ot">,</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;per_page&#39;</span> =&gt; <span class="va">$perPage</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    ])<span class="ot">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="react-component-breakdown-index.tsx">2. React Component
Breakdown (Index.tsx)</h3>
<h4 id="data-flow">Data Flow:</h4>
<ol type="1">
<li><strong>Initial Load</strong>:
<ul>
<li>Laravel renders the page with initial data</li>
<li>React receives <code>company_list</code>, <code>client_list</code>,
<code>pagination</code>, and <code>filters</code> as props</li>
</ul></li>
<li><strong>Filtering</strong>:
<ul>
<li>When user interacts with filters, React updates the URL with new
parameters</li>
<li>Inertia makes a new request to Laravel</li>
<li>Laravel returns filtered data</li>
<li>React re-renders with updated data</li>
</ul></li>
</ol>
<h4 id="key-sections">Key Sections:</h4>
<pre class="tsx"><code>// 1. Define Types (for TypeScript)
type Client = {
    id: number;
    name: string;
    // ... other fields ...
    company: { id: number; name: string } | null;
    contact_count: number;
};

// 2. Main Component
export default function Index() {
    // Get initial data from server
    const { props } = usePage&lt;PageProps&gt;();
    const { company_list, client_list, pagination, filters } = props;
    
    // 3. Local state for filters
    const [searchQuery, setSearchQuery] = useState(filters.search || &#39;&#39;);
    const [filterCompany, setFilterCompany] = useState(filters.company_id || &#39;all&#39;);
    const [perPage, setPerPage] = useState(filters.per_page || 10);
    
    // 4. Filter handler functions
    const fetchClients = (params) =&gt; {
        router.get(&#39;/client&#39;, {
            search: params.search ?? searchQuery,
            company_id: params.company_id ?? filterCompany,
            per_page: params.per_page ?? perPage,
            page: params.page ?? 1
        }, {
            preserveState: true,
            replace: true
        });
    };
    
    // 5. UI Components
    return (
        &lt;AppLayout&gt;
            {/* Search Input */}
            &lt;input
                value={searchQuery}
                onChange={(e) =&gt; {
                    setSearchQuery(e.target.value);
                    fetchClients({ search: e.target.value, page: 1 });
                }}
            /&gt;
            
            {/* Company Filter Dropdown */}
            &lt;select
                value={filterCompany}
                onChange={(e) =&gt; {
                    const value = e.target.value;
                    setFilterCompany(value);
                    fetchClients({ 
                        company_id: value === &#39;all&#39; ? null : value,
                        page: 1 
                    });
                }}
            &gt;
                &lt;option value=&quot;all&quot;&gt;All Companies&lt;/option&gt;
                {company_list.map(company =&gt; (
                    &lt;option key={company.id} value={company.id}&gt;
                        {company.name}
                    &lt;/option&gt;
                ))}
            &lt;/select&gt;
            
            {/* Client Table */}
            &lt;table&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;ID&lt;/th&gt;
                        &lt;th&gt;Name&lt;/th&gt;
                        {/* ... other headers ... */}
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    {client_list.map(client =&gt; (
                        &lt;tr key={client.id}&gt;
                            &lt;td&gt;{client.id}&lt;/td&gt;
                            &lt;td&gt;{client.name}&lt;/td&gt;
                            {/* ... other cells ... */}
                        &lt;/tr&gt;
                    ))}
                &lt;/tbody&gt;
            &lt;/table&gt;
            
            {/* Pagination */}
            {perPage !== &#39;all&#39; &amp;&amp; (
                &lt;Pagination
                    currentPage={pagination.current_page}
                    totalPages={pagination.last_page}
                    onPageChange={(page) =&gt; fetchClients({ page })}
                /&gt;
            )}
        &lt;/AppLayout&gt;
    );
}</code></pre>
<h3 id="interaction-flow">3. Interaction Flow</h3>
<ol type="1">
<li><p><strong>Initial Page Load</strong>:</p>
<pre class="mermaid"><code>sequenceDiagram
    Browser-&gt;&gt;Laravel: GET /client
    Laravel-&gt;&gt;Database: Query clients with filters
    Database-&gt;&gt;Laravel: Return client data
    Laravel-&gt;&gt;Browser: Render page with initial data</code></pre></li>
<li><p><strong>User Filters Data</strong>:</p>
<pre class="mermaid"><code>sequenceDiagram
    Browser-&gt;&gt;React: User types in search
    React-&gt;&gt;Browser: Update search input
    React-&gt;&gt;Laravel: GET /client?search=term
    Laravel-&gt;&gt;Database: Query with new filters
    Database-&gt;&gt;Laravel: Return filtered data
    Laravel-&gt;&gt;Browser: Update with new results
    React-&gt;&gt;Browser: Re-render table</code></pre></li>
</ol>
<h3 id="key-files-structure">4. Key Files Structure</h3>
<pre><code>app/
  Http/
    Controllers/
      ClientController.php
resources/
  js/
    Pages/
      Client/
        Index.tsx
    Components/
      Pagination.tsx</code></pre>
<h3 id="simplified-version-just-listing">Simplified Version (Just
Listing)</h3>
<p>If you want just the basic listing without filters:</p>
<p><strong>Controller:</strong></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> index()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">I</span>nertia::render(<span class="st">&#39;Client/Index&#39;</span><span class="ot">,</span> [</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;clients&#39;</span> =&gt; <span class="cn">M</span>odelsClient::with(<span class="st">&#39;company&#39;</span>)-&gt;paginate(<span class="dv">25</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    ])<span class="ot">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>React Component:</strong></p>
<pre class="tsx"><code>import { Head, Link } from &#39;@inertiajs/react&#39;;

export default function ClientIndex({ clients }) {
    return (
        &lt;div&gt;
            &lt;Head title=&quot;Clients&quot; /&gt;
            &lt;h1&gt;Clients&lt;/h1&gt;
            
            &lt;table&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;Name&lt;/th&gt;
                        &lt;th&gt;Company&lt;/th&gt;
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    {clients.data.map(client =&gt; (
                        &lt;tr key={client.id}&gt;
                            &lt;td&gt;{client.name}&lt;/td&gt;
                            &lt;td&gt;{client.company?.name || &#39;-&#39;}&lt;/td&gt;
                        &lt;/tr&gt;
                    ))}
                &lt;/tbody&gt;
            &lt;/table&gt;
            
            {/* Simple pagination links */}
            {clients.links()}
        &lt;/div&gt;
    );
}</code></pre>
<p>Would you like me to: 1. Explain any specific part in more detail? 2.
Show how to add any particular feature (like sorting)? 3. Break down the
edit/create forms in the same way?</p>
