<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Laravel 12 + Inertia + React Post CRUD Guide with Images</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            line-height: 1.6; 
            margin: 0; 
            padding: 0; 
            background-color: #f9fafb; 
            color: #333; 
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            padding: 40px; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        h1 { 
            color: #1f2937; 
            border-bottom: 2px solid #3b82f6; 
            padding-bottom: 10px; 
        }
        h2 { 
            color: #374151; 
            margin-top: 30px; 
            cursor: pointer;
            position: relative;
        }
        h2:hover { color: #3b82f6; }
        h3 { 
            color: #4b5563; 
        }
        code { 
            background: #f3f4f6; 
            padding: 2px 4px; 
            border-radius: 4px; 
            font-family: 'Courier New', monospace; 
        }
        pre { 
            background: #1f2937; 
            color: #f9fafb; 
            padding: 15px; 
            border-radius: 6px; 
            overflow-x: auto;
            position: relative;
            white-space: pre-wrap;
        }
        pre code {
            background: none;
            padding: 0;
            white-space: pre-wrap;
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #3b82f6;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .copy-btn:hover { background: #2563eb; }
        .section { 
            margin-bottom: 40px; 
            border-left: 4px solid #e5e7eb;
            padding-left: 20px;
        }
        .emoji { 
            font-size: 1.2em; 
            margin-right: 5px; 
        }
        ul, ol { 
            padding-left: 20px; 
        }
        table { 
            border-collapse: collapse; 
            width: 100%; 
            margin-top: 10px; 
        }
        th, td { 
            border: 1px solid #d1d5db; 
            padding: 8px; 
            text-align: left; 
        }
        th { 
            background-color: #f3f4f6; 
        }
        .sidebar {
            position: fixed;
            left: 20px;
            top: 20px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-height: 80vh;
            overflow-y: auto;
            width: 250px;
        }
        .sidebar h3 { font-size: 1.1em; margin-bottom: 10px; }
        .sidebar ul { list-style: none; padding: 0; }
        .sidebar li { margin-bottom: 5px; }
        .sidebar a { 
            display: block; 
            padding: 5px 10px; 
            text-decoration: none; 
            color: #374151; 
            border-radius: 4px; 
            transition: background 0.2s; 
        }
        .sidebar a:hover { color: #3b82f6; background: #f3f4f6; }
        .sidebar a.active { 
            background: #3b82f6; 
            color: white; 
        }
        .main-content { margin-left: 280px; }
        .prerequisites { background: #f0f9ff; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .troubleshooting { background: #fef3c7; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .faq { background: #f3f4f6; padding: 20px; border-radius: 8px; }
        .faq details { margin-bottom: 10px; }
        .image-placeholder { 
            background: #e5e7eb; 
            border: 2px dashed #9ca3af; 
            padding: 40px; 
            text-align: center; 
            margin: 20px 0; 
            border-radius: 8px; 
        }
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; }
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const pre = this.closest('pre');
                    const code = pre.querySelector('code').innerText || pre.querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        const originalText = this.textContent;
                        this.textContent = 'Copied!';
                        setTimeout(() => { this.textContent = originalText; }, 2000);
                    }).catch(err => console.error('Failed to copy: ', err));
                });
            });

            // Active TOC
            const sections = document.querySelectorAll('.section');
            const navLinks = document.querySelectorAll('.sidebar a');
            function updateActive() {
                let current = '';
                sections.forEach(section => {
                    const rect = section.getBoundingClientRect();
                    if (rect.top <= 100) {
                        current = section.getAttribute('id') || '';
                    }
                });
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${current}`) {
                        link.classList.add('active');
                    }
                });
            }
            window.addEventListener('scroll', updateActive);
            updateActive();

            document.querySelectorAll('.sidebar a').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });
        });
    </script>
</head>
<body>
    <nav class="sidebar">
        <h3>üìñ Table of Contents</h3>
        <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#prerequisites">Prerequisites</a></li>
            <li><a href="#setup-model">1. Setup & Post Model</a></li>
            <li><a href="#backend-controller">2. Backend Controller</a></li>
            <li><a href="#routes">3. Routes</a></li>
            <li><a href="#frontend-index">4. Frontend: Index.tsx</a></li>
            <li><a href="#frontend-create">5. Frontend: Create.tsx</a></li>
            <li><a href="#frontend-edit">6. Frontend: Edit.tsx</a></li>
            <li><a href="#frontend-show">7. Frontend: Show.tsx</a></li>
            <li><a href="#app-layout">8. AppLayout.tsx (Updated for Flash)</a></li>
            <li><a href="#testing">9. Testing</a></li>
            <li><a href="#faq">FAQ</a></li>
        </ul>
    </nav>

    <div class="main-content">
        <div class="container">
            <h1><span class="emoji">üìö</span>Complete Laravel 12 + Inertia + React Post CRUD Guide with Images</h1>
            
            <p><strong>Updated:</strong> October 03, 2025</p>
            <p>This is the complete, copy-paste-ready code for a full CRUD post management system with image uploads. Includes model, migration, controller, routes, and all React components. Run <code>php artisan storage:link</code> for images.</p>

            <div class="section" id="overview">
                <h2><span class="emoji">üöÄ</span> Overview</h2>
                <p>Full CRUD: Index (table with search/sort/paginate/images), Create/Edit (forms with file upload), Show (view with image), Delete (modal). Backend validation, flash messages, image storage.</p>
            </div>

            <div class="section" id="prerequisites">
                <h2><span class="emoji">üîß</span> Prerequisites</h2>
                <div class="prerequisites">
                    <ul>
                        <li>Laravel 12 fresh install with Inertia/React.</li>
                        <li>Shadcn/UI: <code>npx shadcn-ui@latest add table input button dialog form label textarea</code></li>
                        <li>Storage: <code>php artisan storage:link</code></li>
                        <li>Migrate/Seed: <code>php artisan migrate</code>; <code>php artisan db:seed --class=PostSeeder</code></li>
                    </ul>
                </div>
            </div>

            <div class="section" id="setup-model">
                <h2><span class="emoji">üìã</span> 1. Setup & Post Model</h2>

                <h3>üìä Migration (<code>database/migrations/create_posts_table.php</code>)</h3>
                <pre><code class="language-php">&lt;?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up(): void
    {
        Schema::create('posts', function (Blueprint $table) {
            $table-&gt;id();
            $table-&gt;string('title')-&gt;index();
            $table-&gt;text('content');
            $table-&gt;string('image')-&gt;nullable();
            $table-&gt;timestamps();
            $table-&gt;index('created_at');
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('posts');
    }
};
?&gt;</code><button class="copy-btn">Copy</button></pre>

                <h3>üìù Post Model (<code>app/Models/Post.php</code>)</h3>
                <pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Builder;
use Illuminate\Support\Facades\Storage;

/**
 * Post Model with image support.
 * 
 * @property int $id
 * @property string $title
 * @property string $content
 * @property string|null $image
 * @property \Illuminate\Support\Carbon $created_at
 * @property \Illuminate\Support\Carbon $updated_at
 * @property-read string $image_url
 * @property-read string $excerpt
 */
class Post extends Model
{
    use HasFactory;

    protected $fillable = [
        'title',
        'content',
        'image'
    ];

    protected $casts = [
        'created_at' =&gt; 'datetime',
        'updated_at' =&gt; 'datetime',
    ];

    public function scopeSearch(Builder $query, string $search): Builder
    {
        return $query-&gt;where(function ($q) use ($search) {
            $q-&gt;where('title', 'like', "%{$search}%")
              -&gt;orWhere('content', 'like', "%{$search}%");
        });
    }

    public function getExcerptAttribute(): string
    {
        return strlen($this-&gt;content) &gt; 100
            ? substr($this-&gt;content, 0, 100) . '...'
            : $this-&gt;content;
    }

    public function getImageUrlAttribute(): ?string
    {
        return $this-&gt;image ? Storage::url($this-&gt;image) : null;
    }
}
?&gt;</code><button class="copy-btn">Copy</button></pre>

                <h3>üå± PostSeeder (<code>database/seeders/PostSeeder.php</code>)</h3>
                <pre><code class="language-php">&lt;?php

namespace Database\Seeders;

use App\Models\Post;
use Illuminate\Database\Seeder;

class PostSeeder extends Seeder
{
    public function run(): void
    {
        Post::factory()-&gt;count(20)-&gt;create();
    }
}
?&gt;</code><button class="copy-btn">Copy</button></pre>
            </div>

            <div class="section" id="backend-controller">
                <h2><span class="emoji">üöÄ</span> 2. Backend Controller</h2>

                <h3>üìã PostController (<code>app/Http/Controllers/PostController.php</code>)</h3>
                <pre><code class="language-php">&lt;?php

namespace App\Http\Controllers;

use App\Models\Post;
use Illuminate\Http\Request;
use Illuminate\Http\RedirectResponse;
use Inertia\Inertia;
use Inertia\Response;
use Illuminate\Support\Facades\Storage;

/**
 * Full CRUD PostController with image handling.
 */
class PostController extends Controller
{
    public function index(Request $request): Response
    {
        $query = Post::query();

        $search = $request-&gt;get('search');
        if ($search) {
            $query-&gt;search($search);
        }

        $sortBy = $request-&gt;get('sort_by', 'created_at');
        $sortDirection = $request-&gt;get('sort_direction', 'desc');
        $query-&gt;orderBy($sortBy, $sortDirection);

        $posts = $query-&gt;paginate(10)-&gt;withQueryString();

        return Inertia::render('Posts/Index', [
            'posts' =&gt; $posts,
            'filters' =&gt; [
                'search' =&gt; $search ?? '',
                'sort_by' =&gt; $sortBy,
                'sort_direction' =&gt; $sortDirection,
            ],
        ]);
    }

    public function create(): Response
    {
        return Inertia::render('Posts/Create');
    }

    public function store(Request $request): RedirectResponse
    {
        $validated = $request-&gt;validate([
            'title' =&gt; 'required|string|max:255',
            'content' =&gt; 'required|string|min:10',
            'image' =&gt; 'nullable|image|mimes:jpeg,png,jpg,gif|max:2048',
        ]);

        try {
            if ($request-&gt;hasFile('image')) {
                $validated['image'] = $request-&gt;file('image')-&gt;store('posts', 'public');
            }

            $post = Post::create($validated);
            return redirect()-&gt;route('posts.index')-&gt;with('success', "Post '{$post-&gt;title}' created!");
        } catch (\Exception $e) {
            return back()-&gt;withInput()-&gt;with('error', 'Failed to create post.');
        }
    }

    public function show(Post $post): Response
    {
        return Inertia::render('Posts/Show', [
            'post' =&gt; [
                'id' =&gt; $post-&gt;id,
                'title' =&gt; $post-&gt;title,
                'content' =&gt; $post-&gt;content,
                'image_url' =&gt; $post-&gt;image_url,
                'created_at' =&gt; $post-&gt;created_at-&gt;format('M d, Y H:i'),
                'updated_at' =&gt; $post-&gt;updated_at-&gt;format('M d, Y H:i'),
            ],
        ]);
    }

    public function edit(Post $post): Response
    {
        return Inertia::render('Posts/Edit', [
            'post' =&gt; [
                'id' =&gt; $post-&gt;id,
                'title' =&gt; $post-&gt;title,
                'content' =&gt; $post-&gt;content,
                'image_url' =&gt; $post-&gt;image_url,
            ],
        ]);
    }

    public function update(Request $request, Post $post): RedirectResponse
    {
        $validated = $request-&gt;validate([
            'title' =&gt; 'required|string|max:255',
            'content' =&gt; 'required|string|min:10',
            'image' =&gt; 'nullable|image|mimes:jpeg,png,jpg,gif|max:2048',
        ]);

        try {
            if ($request-&gt;hasFile('image')) {
                if ($post-&gt;image) {
                    Storage::disk('public')-&gt;delete($post-&gt;image);
                }
                $validated['image'] = $request-&gt;file('image')-&gt;store('posts', 'public');
            }

            $post-&gt;update($validated);
            return redirect()-&gt;route('posts.index')-&gt;with('success', "Post '{$post-&gt;title}' updated!");
        } catch (\Exception $e) {
            return back()-&gt;withInput()-&gt;with('error', 'Failed to update post.');
        }
    }

    public function destroy(Post $post): RedirectResponse
    {
        try {
            if ($post-&gt;image) {
                Storage::disk('public')-&gt;delete($post-&gt;image);
            }
            $title = $post-&gt;title;
            $post-&gt;delete();
            return redirect()-&gt;route('posts.index')-&gt;with('success', "Post '{$title}' deleted!");
        } catch (\Exception $e) {
            return back()-&gt;with('error', 'Failed to delete post.');
        }
    }
}
?&gt;</code><button class="copy-btn">Copy</button></pre>
            </div>

            <div class="section" id="routes">
                <h2><span class="emoji">üõ§Ô∏è</span> 3. Routes</h2>

                <h3>üìã routes/web.php</h3>
                <pre><code class="language-php">&lt;?php

use App\Http\Controllers\PostController;
use Illuminate\Support\Facades\Route;

Route::resource('posts', PostController::class);
?&gt;</code><button class="copy-btn">Copy</button></pre>
            </div>

            <div class="section" id="frontend-index">
                <h2><span class="emoji">üìã</span> 4. Frontend: Index.tsx</h2>

                <pre><code class="language-tsx">import React, { useState } from 'react';
import { Head, router, Link } from '@inertiajs/react';
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/Components/ui/table';
import { Input } from '@/Components/ui/input';
import { Button } from '@/Components/ui/button';
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/Components/ui/dialog';
import { Trash2, Image as ImageIcon } from 'lucide-react';
import { useForm } from '@inertiajs/react';
import AppLayout from '@/Layouts/AppLayout';

interface Post {
  id: number;
  title: string;
  content: string;
  excerpt: string;
  image_url: string | null;
  created_at: string;
  updated_at: string;
}

interface Props {
  posts: {
    data: Post[];
    links: any[];
    current_page: number;
    last_page: number;
    total: number;
  };
  filters: {
    search: string;
    sort_by: string;
    sort_direction: string;
  };
  flash: { success?: string; error?: string; };
}

export default function Index({ posts, filters, flash }: Props) {
  const [search, setSearch] = useState(filters.search);
  const [deletingId, setDeletingId] = useState&lt;number | null&gt;(null);

  const { delete: deletePost, processing } = useForm();

  const handleSearch = (e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {
    const value = e.target.value;
    setSearch(value);
    router.get('/posts', { search: value, page: 1 }, { preserveState: true, replace: true });
  };

  const handleSort = (column: string) =&gt; {
    const direction = filters.sort_by === column &amp;&amp; filters.sort_direction === 'asc' ? 'desc' : 'asc';
    router.get('/posts', { sort_by: column, sort_direction: direction, page: 1 }, { preserveState: true, replace: true });
  };

  const confirmDelete = (id: number) =&gt; {
    setDeletingId(id);
  };

  const handleDelete = () =&gt; {
    if (deletingId) {
      deletePost(route('posts.destroy', deletingId), {
        onSuccess: () =&gt; setDeletingId(null),
      });
    }
  };

  const renderPagination = () =&gt; {
    return (
      &lt;div className="flex justify-center space-x-2 mt-4"&gt;
        {posts.links.map((link: any, index: number) =&gt; (
          &lt;Link
            key={index}
            href={link.url || '#'}
            className={`px-3 py-2 rounded ${link.active ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'} ${!link.url &amp;&amp; 'pointer-events-none opacity-50'}`}
            preserveState
          &gt;
            {link.label}
          &lt;/Link&gt;
        ))}
      &lt;/div&gt;
    );
  };

  if (posts.data.length === 0) {
    return (
      &lt;AppLayout&gt;
        &lt;Head title="Posts" /&gt;
        &lt;div className="py-12 text-center"&gt;
          &lt;h2 className="text-xl font-semibold mb-2"&gt;No Posts&lt;/h2&gt;
          &lt;p className="text-gray-500"&gt;Try searching or &lt;Link href={route('posts.create')} className="text-blue-500"&gt;create one&lt;/Link&gt;.&lt;/p&gt;
        &lt;/div&gt;
      &lt;/AppLayout&gt;
    );
  }

  return (
    &lt;AppLayout&gt;
      &lt;Head title="Posts" /&gt;
      &lt;div className="container mx-auto py-6 px-4"&gt;
        {flash.success &amp;&amp; &lt;div className="bg-green-100 border border-green-400 text-green-700 p-4 rounded mb-4"&gt;{flash.success}&lt;/div&gt;}
        {flash.error &amp;&amp; &lt;div className="bg-red-100 border border-red-400 text-red-700 p-4 rounded mb-4"&gt;{flash.error}&lt;/div&gt;}
        &lt;div className="flex justify-between items-center mb-6"&gt;
          &lt;h1 className="text-2xl font-bold"&gt;Posts ({posts.total})&lt;/h1&gt;
          &lt;Dialog&gt;
            &lt;DialogTrigger asChild&gt;
              &lt;Button&gt;+ Add Post&lt;/Button&gt;
            &lt;/DialogTrigger&gt;
            &lt;DialogContent className="max-w-md"&gt;
              &lt;DialogHeader&gt;
                &lt;DialogTitle&gt;Create Post&lt;/DialogTitle&gt;
              &lt;/DialogHeader&gt;
              &lt;form&gt;
                &lt;Input placeholder="Title" className="mb-2" /&gt;
                &lt;Textarea placeholder="Content" className="mb-2" rows={4} /&gt;
                &lt;Input type="file" accept="image/*" className="mb-2" /&gt;
                &lt;Button type="submit"&gt;Create&lt;/Button&gt;
              &lt;/form&gt;
            &lt;/DialogContent&gt;
          &lt;/Dialog&gt;
        &lt;/div&gt;
        &lt;Input
          type="text"
          placeholder="Search title or content..."
          value={search}
          onChange={handleSearch}
          className="mb-4 max-w-md"
        /&gt;
        &lt;Table&gt;
          &lt;TableHeader&gt;
            &lt;TableRow&gt;
              &lt;TableHead className="cursor-pointer" onClick={() =&gt; handleSort('id')}&gt;ID&lt;/TableHead&gt;
              &lt;TableHead className="cursor-pointer" onClick={() =&gt; handleSort('title')}&gt;
                Title
                {filters.sort_by === 'title' &amp;&amp; (filters.sort_direction === 'asc' ? &lt;ChevronUp className="inline ml-1 h-4 w-4" /&gt; : &lt;ChevronDown className="inline ml-1 h-4 w-4" /&gt;)}
              &lt;/TableHead&gt;
              &lt;TableHead&gt;Image&lt;/TableHead&gt;
              &lt;TableHead&gt;Content Excerpt&lt;/TableHead&gt;
              &lt;TableHead className="cursor-pointer" onClick={() =&gt; handleSort('created_at')}&gt;
                Created At
                {filters.sort_by === 'created_at' &amp;&amp; (filters.sort_direction === 'asc' ? &lt;ChevronUp className="inline ml-1 h-4 w-4" /&gt; : &lt;ChevronDown className="inline ml-1 h-4 w-4" /&gt;)}
              &lt;/TableHead&gt;
              &lt;TableHead&gt;Updated At&lt;/TableHead&gt;
              &lt;TableHead&gt;Actions&lt;/TableHead&gt;
            &lt;/TableRow&gt;
          &lt;/TableHeader&gt;
          &lt;TableBody&gt;
            {posts.data.map((post: Post) =&gt; (
              &lt;TableRow key={post.id}&gt;
                &lt;TableCell&gt;{post.id}&lt;/TableCell&gt;
                &lt;TableCell&gt;{post.title}&lt;/TableCell&gt;
                &lt;TableCell&gt;
                  {post.image_url ? (
                    &lt;img src={post.image_url} alt="" className="w-12 h-12 object-cover rounded" /&gt;
                  ) : (
                    &lt;ImageIcon className="w-12 h-12 text-gray-300" /&gt;
                  )}
                &lt;/TableCell&gt;
                &lt;TableCell className="text-sm"&gt;{post.excerpt}&lt;/TableCell&gt;
                &lt;TableCell&gt;{post.created_at}&lt;/TableCell&gt;
                &lt;TableCell&gt;{post.updated_at}&lt;/TableCell&gt;
                &lt;TableCell&gt;
                  &lt;Link href={route('posts.show', post.id)} className="text-blue-500 mr-2"&gt;View&lt;/Link&gt;
                  &lt;Link href={route('posts.edit', post.id)} className="text-green-500 mr-2"&gt;Edit&lt;/Link&gt;
                  &lt;Button variant="ghost" size="sm" onClick={() =&gt; confirmDelete(post.id)}&gt;
                    &lt;Trash2 className="h-4 w-4" /&gt;
                  &lt;/Button&gt;
                &lt;/TableCell&gt;
              &lt;/TableRow&gt;
            ))}
          &lt;/TableBody&gt;
        &lt;/Table&gt;
        {renderPagination()}

        {deletingId &amp;&amp; (
          &lt;Dialog open={!!deletingId} onOpenChange={() =&gt; setDeletingId(null)}&gt;
            &lt;DialogContent&gt;
              &lt;DialogHeader&gt;
                &lt;DialogTitle&gt;Confirm Delete&lt;/DialogTitle&gt;
              &lt;/DialogHeader&gt;
              &lt;p&gt;Are you sure you want to delete this post?&lt;/p&gt;
              &lt;div className="flex justify-end space-x-2"&gt;
                &lt;Button variant="outline" onClick={() =&gt; setDeletingId(null)}&gt;Cancel&lt;/Button&gt;
                &lt;Button variant="destructive" onClick={handleDelete} disabled={processing}&gt;
                  {processing ? 'Deleting...' : 'Delete'}
                &lt;/Button&gt;
              &lt;/div&gt;
            &lt;/DialogContent&gt;
          &lt;/Dialog&gt;
        )}
      &lt;/div&gt;
    &lt;/AppLayout&gt;
  );
}
</code><button class="copy-btn">Copy</button></pre>
            </div>

            <div class="section" id="frontend-create">
                <h2><span class="emoji">üìã</span> 5. Frontend: Create.tsx</h2>

                <pre><code class="language-tsx">import { Head, useForm } from '@inertiajs/react';
import { Button } from '@/Components/ui/button';
import { Input } from '@/Components/ui/input';
import { Label } from '@/Components/ui/label';
import { Textarea } from '@/Components/ui/textarea';
import { Link } from '@inertiajs/react';
import AppLayout from '@/Layouts/AppLayout';

export default function Create() {
  const { data, setData, post, processing, errors } = useForm({
    title: '',
    content: '',
    image: null as File | null,
  });

  const handleImageChange = (e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {
    if (e.target.files &amp;&amp; e.target.files[0]) {
      setData('image', e.target.files[0]);
    }
  };

  const handleSubmit = (e: React.FormEvent) =&gt; {
    e.preventDefault();
    post(route('posts.store'));
  };

  return (
    &lt;AppLayout&gt;
      &lt;Head title="Create Post" /&gt;
      &lt;div className="container mx-auto py-6 px-4"&gt;
        &lt;h1 className="text-2xl font-bold mb-6"&gt;Create Post&lt;/h1&gt;
        &lt;form onSubmit={handleSubmit} className="space-y-4 max-w-md"&gt;
          &lt;div&gt;
            &lt;Label htmlFor="title"&gt;Title&lt;/Label&gt;
            &lt;Input
              id="title"
              value={data.title}
              onChange={(e) =&gt; setData('title', e.target.value)}
              className={errors.title ? 'border-red-500' : ''}
            /&gt;
            {errors.title &amp;&amp; &lt;p className="text-red-500 text-sm mt-1"&gt;{errors.title}&lt;/p&gt;}
          &lt;/div&gt;
          &lt;div&gt;
            &lt;Label htmlFor="content"&gt;Content&lt;/Label&gt;
            &lt;Textarea
              id="content"
              value={data.content}
              onChange={(e) =&gt; setData('content', e.target.value)}
              className={errors.content ? 'border-red-500' : ''}
              rows={5}
            /&gt;
            {errors.content &amp;&amp; &lt;p className="text-red-500 text-sm mt-1"&gt;{errors.content}&lt;/p&gt;}
          &lt;/div&gt;
          &lt;div&gt;
            &lt;Label htmlFor="image"&gt;Featured Image (Optional)&lt;/Label&gt;
            &lt;Input
              id="image"
              type="file"
              accept="image/*"
              onChange={handleImageChange}
              className={errors.image ? 'border-red-500' : ''}
            /&gt;
            {errors.image &amp;&amp; &lt;p className="text-red-500 text-sm mt-1"&gt;{errors.image}&lt;/p&gt;}
          &lt;/div&gt;
          &lt;div className="flex space-x-2"&gt;
            &lt;Button type="submit" disabled={processing}&gt;{processing ? 'Creating...' : 'Create Post'}&lt;/Button&gt;
            &lt;Button variant="outline" asChild&gt;
              &lt;Link href={route('posts.index')}&gt;Cancel&lt;/Link&gt;
            &lt;/Button&gt;
          &lt;/div&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/AppLayout&gt;
  );
}
</code><button class="copy-btn">Copy</button></pre>
            </div>

            <div class="section" id="frontend-edit">
                <h2><span class="emoji">üìã</span> 6. Frontend: Edit.tsx</h2>

                <pre><code class="language-tsx">import { Head, useForm } from '@inertiajs/react';
import { Button } from '@/Components/ui/button';
import { Input } from '@/Components/ui/input';
import { Label } from '@/Components/ui/label';
import { Textarea } from '@/Components/ui/textarea';
import { Link } from '@inertiajs/react';
import AppLayout from '@/Layouts/AppLayout';

interface Props {
  post: {
    id: number;
    title: string;
    content: string;
    image_url: string | null;
  };
}

export default function Edit({ post }: Props) {
  const { data, setData, put, processing, errors } = useForm({
    title: post.title,
    content: post.content,
    image: null as File | null,
  });

  const [preview, setPreview] = useState(post.image_url || null);

  const handleImageChange = (e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {
    if (e.target.files &amp;&amp; e.target.files[0]) {
      const file = e.target.files[0];
      setData('image', file);
      setPreview(URL.createObjectURL(file));
    }
  };

  const handleSubmit = (e: React.FormEvent) =&gt; {
    e.preventDefault();
    put(route('posts.update', post.id));
  };

  return (
    &lt;AppLayout&gt;
      &lt;Head title="Edit Post" /&gt;
      &lt;div className="container mx-auto py-6 px-4"&gt;
        &lt;h1 className="text-2xl font-bold mb-6"&gt;Edit Post&lt;/h1&gt;
        &lt;form onSubmit={handleSubmit} className="space-y-4 max-w-md"&gt;
          &lt;div&gt;
            &lt;Label htmlFor="title"&gt;Title&lt;/Label&gt;
            &lt;Input
              id="title"
              value={data.title}
              onChange={(e) =&gt; setData('title', e.target.value)}
              className={errors.title ? 'border-red-500' : ''}
            /&gt;
            {errors.title &amp;&amp; &lt;p className="text-red-500 text-sm mt-1"&gt;{errors.title}&lt;/p&gt;}
          &lt;/div&gt;
          &lt;div&gt;
            &lt;Label htmlFor="content"&gt;Content&lt;/Label&gt;
            &lt;Textarea
              id="content"
              value={data.content}
              onChange={(e) =&gt; setData('content', e.target.value)}
              className={errors.content ? 'border-red-500' : ''}
              rows={5}
            /&gt;
            {errors.content &amp;&amp; &lt;p className="text-red-500 text-sm mt-1"&gt;{errors.content}&lt;/p&gt;}
          &lt;/div&gt;
          &lt;div&gt;
            &lt;Label htmlFor="image"&gt;Featured Image&lt;/Label&gt;
            {preview &amp;&amp; &lt;img src={preview} alt="Preview" className="w-32 h-32 object-cover rounded mb-2" /&gt;}
            &lt;Input
              id="image"
              type="file"
              accept="image/*"
              onChange={handleImageChange}
              className={errors.image ? 'border-red-500' : ''}
            /&gt;
            {errors.image &amp;&amp; &lt;p className="text-red-500 text-sm mt-1"&gt;{errors.image}&lt;/p&gt;}
          &lt;/div&gt;
          &lt;div className="flex space-x-2"&gt;
            &lt;Button type="submit" disabled={processing}&gt;{processing ? 'Updating...' : 'Update Post'}&lt;/Button&gt;
            &lt;Button variant="outline" asChild&gt;
              &lt;Link href={route('posts.index')}&gt;Cancel&lt;/Link&gt;
            &lt;/Button&gt;
          &lt;/div&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/AppLayout&gt;
  );
}
</code><button class="copy-btn">Copy</button></pre>
            </div>

            <div class="section" id="frontend-show">
                <h2><span class="emoji">üìã</span> 7. Frontend: Show.tsx</h2>

                <pre><code class="language-tsx">import { Head, Link } from '@inertiajs/react';
import AppLayout from '@/Layouts/AppLayout';

interface Props {
  post: {
    id: number;
    title: string;
    content: string;
    image_url: string | null;
    created_at: string;
    updated_at: string;
  };
}

export default function Show({ post }: Props) {
  return (
    &lt;AppLayout&gt;
      &lt;Head title={post.title} /&gt;
      &lt;div className="container mx-auto py-6 px-4"&gt;
        &lt;div className="max-w-2xl"&gt;
          &lt;h1 className="text-3xl font-bold mb-4"&gt;{post.title}&lt;/h1&gt;
          {post.image_url &amp;&amp; (
            &lt;img src={post.image_url} alt={post.title} className="w-full max-w-md rounded mb-4 object-cover" /&gt;
          )}
          &lt;p className="text-gray-600 mb-4"&gt;Created: {post.created_at} | Updated: {post.updated_at}&lt;/p&gt;
          &lt;div className="prose max-w-none"&gt;
            &lt;div dangerouslySetInnerHTML={{ __html: post.content.replace(/\n/g, '&lt;br&gt;') }} /&gt;
          &lt;/div&gt;
          &lt;div className="mt-6 space-x-2"&gt;
            &lt;Link href={route('posts.edit', post.id)} className="bg-green-500 text-white px-4 py-2 rounded"&gt;Edit&lt;/Link&gt;
            &lt;Link href={route('posts.index')} className="bg-gray-500 text-white px-4 py-2 rounded"&gt;Back to Posts&lt;/Link&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/AppLayout&gt;
  );
}
</code><button class="copy-btn">Copy</button></pre>
            </div>

            <div class="section" id="app-layout">
                <h2><span class="emoji">üèóÔ∏è</span> 8. AppLayout.tsx (Updated for Flash)</h2>

                <pre><code class="language-tsx">import { ReactNode } from 'react';
import { Head } from '@inertiajs/react';

interface Props {
  children: ReactNode;
  title: string;
  flash?: { success?: string; error?: string; };
}

export default function AppLayout({ children, title, flash }: Props) {
  return (
    &lt;&gt;
      &lt;Head title={title} /&gt;
      &lt;header className="bg-white shadow"&gt;
        &lt;div className="max-w-7xl mx-auto py-6 px-4"&gt;
          &lt;h1 className="text-3xl font-bold"&gt;Post Management&lt;/h1&gt;
        &lt;/div&gt;
      &lt;/header&gt;
      &lt;main&gt;
        {children}
      &lt;/main&gt;
    &lt;/&gt;
  );
}
</code><button class="copy-btn">Copy</button></pre>
                <p>In controller, pass flash via session; in layout, show if present.</p>
            </div>

            <div class="section" id="testing">
                <h2><span class="emoji">üß™</span> 9. Testing</h2>
                <pre><code class="language-php">&lt;?php
// tests/Feature/PostTest.php
namespace Tests\Feature;

use App\Models\Post;
use Illuminate\Http\UploadedFile;
use Illuminate\Support\Facades\Storage;
use Tests\TestCase;

class PostTest extends TestCase
{
    public function test_index_search()
    {
        Post::factory()-&gt;create(['title' =&gt; 'Test Post']);
        $response = $this-&gt;get('/posts?search=Test');
        $response-&gt;assertStatus(200);
        $response-&gt;assertInertia(fn ($page) =&gt; $page-&gt;has('posts.data'));
    }

    public function test_store_with_image()
    {
        Storage::fake('public');
        $file = UploadedFile::fake()-&gt;image('test.jpg');
        $data = ['title' =&gt; 'Test', 'content' =&gt; 'Content', 'image' =&gt; $file];
        $response = $this-&gt;post(route('posts.store'), $data);
        $response-&gt;assertRedirect(route('posts.index'));
        Storage::disk('public')-&gt;assertExists(parse_url($this-&gt;post-&gt;fresh()-&gt;image_url, PHP_URL_PATH));
    }
}
?&gt;</code><button class="copy-btn">Copy</button></pre>
            </div>

            <div class="section" id="faq">
                <h2><span class="emoji">‚ùì</span> FAQ</h2>
                <div class="faq">
                    <details>
                        <summary>Images 404?</summary>
                        <p>Run <code>php artisan storage:link</code>; check storage/app/public/posts.</p>
                    </details>
                </div>
            </div>

            <p><strong>Complete code‚Äîdeploy and enjoy!</strong></p>
        </div>
    </div>
</body>
</html>